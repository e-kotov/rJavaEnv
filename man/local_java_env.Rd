% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/java_scoped.R
\name{local_java_env}
\alias{local_java_env}
\title{Set Java environment for the current scope}
\usage{
local_java_env(
  version,
  type = c("exact", "min"),
  distribution = "Corretto",
  install = TRUE,
  accept_system_java = TRUE,
  quiet = TRUE,
  .local_envir = parent.frame(),
  .use_cache = FALSE
)
}
\arguments{
\item{version}{Java version specification. Accepts:
\itemize{
\item \strong{Major version} (e.g., \code{21}, \code{17}): Downloads the latest release for that major version.
\item \strong{Specific version} (e.g., \code{"21.0.9"}, \code{"11.0.29"}): Downloads the exact version.
\item \strong{SDKMAN identifier} (e.g., \code{"25.0.1-amzn"}, \code{"24.0.2-open"}): Uses the SDKMAN
backend automatically. When an identifier is detected, the \code{distribution} and \code{backend}
arguments are \strong{ignored} and derived from the identifier. Find available identifiers
in the \code{identifier} column of \code{\link{java_list_available}(backend = "sdkman")}.
}}

\item{type}{Character. \code{"exact"} (default) checks for exact version match. \code{"min"} checks for version >= \code{version}.}

\item{distribution}{Character. The Java distribution to download. Defaults to "Corretto". Ignored if \code{version} is a SDKMAN identifier.}

\item{install}{Logical. If \code{TRUE} (default), attempts to download/install if missing.
If \code{FALSE}, returns \code{FALSE} if the version is not found.}

\item{accept_system_java}{Logical. If \code{TRUE} (default), the function will scan the system for existing Java installations (using \code{JAVA_HOME}, \code{PATH}, and OS-specific locations). If a system Java matching the \code{version} and \code{type} requirements is found, it will be used. Set to \code{FALSE} to ignore system installations and strictly use an \code{rJavaEnv} managed version.}

\item{quiet}{A \code{logical} value indicating whether to suppress messages. Can be \code{TRUE} or \code{FALSE}.}

\item{.local_envir}{The environment to apply the scope to. Defaults to the calling frame.}

\item{.use_cache}{Logical. If \code{TRUE}, uses cached results for Java version checks,
improving performance in repeated calls (e.g., inside loops).}
}
\value{
Invisibly returns the path to the selected JAVA_HOME.
}
\description{
Sets \code{JAVA_HOME} and \code{PATH} to the specified Java version for the remainder
of the current function or scope. The environment is automatically restored
when the scope exits.
}
\details{
This is the recommended way for package developers to use Java executables
(via \code{system2} or \code{processx}) without permanently altering the user's global environment.
}
\section{Warning - Not for rJava}{

\strong{Do not use this function if your package depends on rJava.}
rJava locks the JVM at initialization and cannot switch versions within a session.
If you load an rJava-dependent package inside a \code{local_java_env()} scope,
rJava will lock to the scoped version, but after the scope exits, \code{JAVA_HOME}
will revert while rJava remains locked to the old version.
For rJava packages, use \code{java_ensure()} at the start of the R session instead.
}

\examples{
\dontrun{
# Using system2
my_tool_wrapper <- function() {
  rJavaEnv::local_java_env(version = 21)
  system2("java", "-version")
} # Environment restored automatically here

# Using processx
run_java_jar <- function(jar_path, args) {
  rJavaEnv::local_java_env(version = 21)
  processx::run("java", c("-jar", jar_path, args))
}

# With caching for repeated calls
process_files <- function(files) {
  for (f in files) {
    rJavaEnv::local_java_env(version = 21, .use_cache = TRUE)
    processx::run("java", c("-jar", "processor.jar", f))
  }
}
}
}
