% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/java_scoped.R
\name{with_rjava_env}
\alias{with_rjava_env}
\title{Execute rJava code in a separate process with specific Java version}
\usage{
with_rjava_env(
  version,
  func,
  args = list(),
  distribution = "Corretto",
  install = TRUE,
  accept_system_java = TRUE,
  quiet = TRUE,
  libpath = .libPaths()
)
}
\arguments{
\item{version}{Java version specification. Accepts:
\itemize{
\item \strong{Major version} (e.g., \code{21}, \code{17}): Downloads the latest release for that major version.
\item \strong{Specific version} (e.g., \code{"21.0.9"}, \code{"11.0.29"}): Downloads the exact version.
\item \strong{SDKMAN identifier} (e.g., \code{"25.0.1-amzn"}, \code{"24.0.2-open"}): Uses the SDKMAN
backend automatically. When an identifier is detected, the \code{distribution} and \code{backend}
arguments are \strong{ignored} and derived from the identifier. Find available identifiers
in the \code{identifier} column of \code{\link{java_list_available}(backend = "sdkman")}.
}}

\item{func}{The function to execute in the subprocess.}

\item{args}{A list of arguments to pass to \code{func}.}

\item{distribution}{Character. The Java distribution to download. Defaults to "Corretto". Ignored if \code{version} is a SDKMAN identifier.}

\item{install}{Logical. If \code{TRUE} (default), attempts to download/install if missing.
If \code{FALSE}, returns \code{FALSE} if the version is not found.}

\item{accept_system_java}{Logical. If \code{TRUE} (default), the function will scan the system for existing Java installations (using \code{JAVA_HOME}, \code{PATH}, and OS-specific locations). If a system Java matching the \code{version} and \code{type} requirements is found, it will be used. Set to \code{FALSE} to ignore system installations and strictly use an \code{rJavaEnv} managed version.}

\item{quiet}{A \code{logical} value indicating whether to suppress messages. Can be \code{TRUE} or \code{FALSE}.}

\item{libpath}{Optional character vector of library paths to use in the subprocess.
Defaults to \code{.libPaths()}.}
}
\value{
The result of \code{func}.
}
\description{
Runs the provided function in a fresh R subprocess where \code{rJava} has not yet
been loaded. This allows you to enforce a specific Java version for \code{rJava}
operations without affecting the main R session or requiring a restart.
}
\details{
This function requires the \pkg{callr} package.
}
\examples{
\dontrun{
# Run a function using Java 21 in a subprocess
result <- with_rjava_env(
  version = 21,
  func = function(x) {
    library(rJava)
    .jinit()
    .jcall("java.lang.System", "S", "getProperty", "java.version")
  },
  args = list(x = 1)
)
print(result)
}
}
