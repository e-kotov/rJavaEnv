% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/use_java.R
\name{use_java}
\alias{use_java}
\title{Install specified Java version and set the \code{JAVA_HOME} and \code{PATH} environment variables in current R session}
\usage{
use_java(
  version = NULL,
  distribution = "Corretto",
  cache_path = getOption("rJavaEnv.cache_path"),
  platform = platform_detect()$os,
  arch = platform_detect()$arch,
  quiet = TRUE,
  ._skip_rjava_check = FALSE
)
}
\arguments{
\item{version}{\code{Integer} or \code{character} vector of length 1 for major version of Java to download or install. If not specified, defaults to the latest LTS version. Can be "8", and "11" to "24" (or the same version numbers in \code{integer}) or any newer version if it is available for the selected distribution. For \code{macOS} on \code{aarch64} architecture (Apple Silicon) certain \code{Java} versions are not available.}

\item{distribution}{The Java distribution to download. If not specified, defaults to "Amazon Corretto". Currently only \href{https://aws.amazon.com/corretto/}{"Amazon Corretto"} is supported.}

\item{cache_path}{The destination directory to download the Java distribution to. Defaults to a user-specific data directory.}

\item{platform}{The platform for which to download the Java distribution. Defaults to the current platform.}

\item{arch}{The architecture for which to download the Java distribution. Defaults to the current architecture.}

\item{quiet}{A \code{logical} value indicating whether to suppress messages. Can be \code{TRUE} or \code{FALSE}.}

\item{._skip_rjava_check}{Internal. If TRUE, skip the rJava initialization check.}
}
\value{
Logical. Returns \code{TRUE} invisibly on success. Prints status messages if \code{quiet} is set to \code{FALSE}.
}
\description{
Using specified Java version, set the \code{JAVA_HOME} and \code{PATH} environment variables in the current R session. If Java distribtuion has not been downloaded yet, download it. If it was not installed into cache directory yet, install it there and then set the environment variables. This function first checks if the requested version is already present in the \code{rJavaEnv} cache. If found, it sets the environment immediately without downloading. If not found, it downloads and unpacks the distribution.

This is intended as a quick and easy way to use different Java versions in R scripts that are in the same project, but require different Java versions. For example, one could use this in scripts that are called by \code{targets} package or \code{callr} package.
}
\section{rJava Path-Locking}{

\strong{Important for \emph{rJava} Users}: This function sets environment variables
(JAVA_HOME, PATH) that affect both command-line Java tools and \emph{rJava} initialization.
However, due to \emph{rJava}'s path-locking behavior when \code{\link[rJava]{.jinit}} is called
(see \url{https://github.com/s-u/rJava/issues/25}, \url{https://github.com/s-u/rJava/issues/249}, and \url{https://github.com/s-u/rJava/issues/334}),
this function must be called \strong{BEFORE} \code{\link[rJava]{.jinit}} is invoked. Once \code{\link[rJava]{.jinit}}
initializes, the Java version is locked for that R session and cannot be changed without restarting R.

\code{\link[rJava]{.jinit}} is invoked (and Java locked) when you:
\itemize{
\item Explicitly call \code{library(rJava)}
\item Load any package that imports \emph{rJava} (which auto-loads it as a dependency)
\item Even just use IDE autocomplete with \code{rJava::} (this triggers initialization!)
\item Call any \emph{rJava}-dependent function
}

Once any of these happen, the Java version used by \emph{rJava} for that session is locked in.
For command-line Java tools that don't use \emph{rJava}, this function can be called at any
time to switch Java versions for subsequent system calls.
}

\examples{
\dontrun{

# set cache directory for Java to be in temporary directory
options(rJavaEnv.cache_path = tempdir())

# For end users: Install and set Java BEFORE loading rJava packages
use_java(21)
library(myRJavaPackage)  # Now uses Java 21

# For command-line Java tools (no rJava involved):
# Can switch versions between system calls
use_java(8)
system2("java", "-version")  # Shows Java 8
use_java(17)
system2("java", "-version")  # Shows Java 17

# WARNING: Do NOT do this with rJava packages:
# library(rJava)          # Initializes with system Java
# use_java(21)            # Too late! rJava is already locked
# rJava still uses the Java version from before use_java() call

}

}
